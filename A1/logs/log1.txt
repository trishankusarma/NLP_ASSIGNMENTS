(base) [aiy257584@scai04 ~/scratch/MSR_IITD_2nd_Sem/NLP_ASSIGNMENTS/A1]
$ bash ./run_model.sh ./data/train_data
Training model...
Training Word2Vec model with skip-grams
Loading data from split_data/train
Loading data from split_data/train/author_001.txt
Loading data from split_data/train/author_002.txt
Loading data from split_data/train/author_003.txt
Loading data from split_data/train/author_004.txt
Loading data from split_data/train/author_005.txt
Loading data from split_data/train/author_006.txt
Loading data from split_data/train/author_007.txt
Loading data from split_data/train/author_008.txt
Loading data from split_data/train/author_009.txt
Loading data from split_data/train/author_010.txt
Data loaded
Building vocabulary...
Document 0: 829229 tokens
Document 1: 550445 tokens
Document 2: 527889 tokens
Document 3: 431849 tokens
Document 4: 594999 tokens
Document 5: 794695 tokens
Document 6: 477634 tokens
Document 7: 840679 tokens
Document 8: 767075 tokens
Document 9: 769858 tokens
Vocabulary size (including UNK): 34164
Creating negative sampling distribution...
Pre-computing Noise Table...
Loading validation data from ./split_data/test/task1_test.json

Epoch 1/5 | LR = 0.050000
62830it [04:30, 231.90it/s]
Epoch 1 done | Avg Loss = 4.1230 | Time = 270.94s
Validating on Task 1...
Processing 50 queries...
Overall Score achieved is 21.984126984126977 and the rank_list is : [4, 2, 3, 8, 3, 1, 3, 2, 7, 7, 1, 3, 1, 1, 1, 2, 2, 1, 3, 2, 4, 1, 1, 5, 3, 8, 1, 4, 5, 4, 2, 3, 3, 3, 5, 5, 3, 1, 2, 3, 2, 7, 6, 4, 9, 4, 5, 2, 4, 9]
MRR : 0.43968253968253956

Epoch 2/5 | LR = 0.040000
62817it [05:42, 183.65it/s]
Epoch 2 done | Avg Loss = 3.9898 | Time = 342.04s
Validating on Task 1...
Processing 50 queries...
Overall Score achieved is 23.171825396825394 and the rank_list is : [4, 2, 3, 8, 3, 1, 3, 3, 6, 6, 1, 4, 1, 2, 1, 2, 2, 1, 3, 2, 4, 1, 1, 5, 1, 7, 1, 4, 4, 3, 2, 3, 3, 4, 5, 4, 3, 1, 1, 6, 1, 7, 8, 4, 9, 4, 4, 2, 2, 8]
MRR : 0.46343650793650787

Epoch 3/5 | LR = 0.030000
62793it [05:44, 182.05it/s]
Epoch 3 done | Avg Loss = 3.7787 | Time = 344.92s
Validating on Task 1...
Processing 50 queries...
Overall Score achieved is 24.550396825396817 and the rank_list is : [4, 1, 2, 7, 3, 1, 3, 3, 6, 7, 1, 4, 1, 1, 1, 2, 2, 1, 3, 2, 4, 1, 1, 6, 1, 7, 1, 4, 5, 2, 2, 3, 3, 4, 5, 3, 3, 1, 1, 7, 1, 6, 8, 5, 9, 4, 3, 2, 2, 7]
MRR : 0.49100793650793634

Epoch 4/5 | LR = 0.020000
62806it [05:19, 196.60it/s]
Epoch 4 done | Avg Loss = 3.6248 | Time = 319.46s
Validating on Task 1...
Processing 50 queries...
Overall Score achieved is 24.551587301587293 and the rank_list is : [4, 1, 2, 7, 3, 1, 3, 3, 5, 7, 1, 4, 1, 1, 1, 2, 2, 1, 3, 2, 5, 1, 1, 6, 1, 7, 1, 4, 5, 2, 2, 3, 3, 4, 5, 3, 3, 1, 1, 7, 1, 6, 7, 4, 9, 5, 3, 2, 2, 7]
MRR : 0.4910317460317459

Epoch 5/5 | LR = 0.010000
62807it [05:17, 197.89it/s]
Epoch 5 done | Avg Loss = 3.5406 | Time = 317.38s
Validating on Task 1...
Processing 50 queries...
Overall Score achieved is 24.55158730158729 and the rank_list is : [4, 1, 2, 7, 3, 1, 3, 4, 5, 7, 1, 4, 1, 1, 1, 2, 2, 1, 3, 2, 5, 1, 1, 5, 1, 7, 1, 4, 5, 2, 2, 3, 3, 4, 4, 3, 3, 1, 1, 7, 1, 6, 7, 4, 9, 5, 3, 2, 2, 7]
MRR : 0.4910317460317458
Loss curve saved to ./output/loss_plot.png
Training complete
Training completed successfully!
Training completed!